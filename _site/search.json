[
  
    {
      "title"       : "Detecting cardiac disfunctions using Transfer Learning",
      "category"    : "project",
      "tags"        : "neural networks, transfer learning, ImageNet",
      "url"         : "./Transfer-Learning-Ecochardia.html",
      "date"        : "2025-06-16 00:00:00 +0200",
      "description" : "",
      "content"     : "Under development"
    } ,
  
    {
      "title"       : "Approaching cliff species distribution using RandomForest ",
      "category"    : "manuscript",
      "tags"        : "R, species distribution modelling, machine learning, artificial intelligence, consrvation",
      "url"         : "./Cliff-species-models.html",
      "date"        : "2025-06-16 00:00:00 +0200",
      "description" : "Predicting ",
      "content"     : "Species Distribution modelling (SDM) is a powerful tool that can be used to understand the distribution of certain species in a given area and be used to inform conservation efforts, especially for species that are threatened or endangered. In this post, we will discuss how we used Random Forests (RF) to model the distribution of cliff species in Mallorca, Balearic Islands, Spain. specific information about methods and results can be found in the original manuscript in the Journal Basic and Applied Ecology.SDMs are supervised learning algortihms that require ocurrence data as response variable and environmental variables as predictors. In this case, the response variable was the presence of cliff species, and the predictors were environmental variables such as altitude, slope, aspect and biolcimatic data. We used WorldClim data to obtain the environmental variables.Data for the study was obtained from the Global Biodiversity Information Facility (GBIF), which provides access to a wide range of biodiversity data. The data was filtered to include only cliff species in Mallorca, and the coordinates were used to create a spatial dataset. This dataset was enlarged with own data collected in the field. Maps were created using QGIS. At the end, 20 species were selected for the analysis, representing over ~3000 occurences.A challenge and one of the most sensible parts of Species distribution modelling is the creation of absence data, which is necessary to train the model. In this case, we generated buffers of 1km areound the presence points and used these buffers to create pseudo-absence points. This method is widely used in SDMs, but it is important to note that it can introduce bias in the model if not done correctly. We used a random sampling approach to select the pseudo-absence points, ensuring that they were not too close to the presence points.library(terra)# Occurrences and Raster loading ####Species_data &lt;- vect(\"~/Cliff_Occurrences_ESTR25831.shp\")Predictive_rasters &lt;- rast(\"~/Predictive_Europe.tif\")Europe_Limits &lt;- vect(\"~/Coastline_Europe_25381.shp\")Balearic_Limits &lt;- vect(\"~/Coastline_BalearicIslands_25831.shp\")# Pseudo-Absence calculation ####absence_multiplier = 2buffers &lt;- buffer(Species_data, 1000)Background_area &lt;- erase(Limites_Europe, aggregate(buffers))Absence_points &lt;- terra::spatSample(Background_area, size = absence_multiplier*nrow(Species_data), method = \"random\")Using this code, we cropped the buffers from the background area (Europe limits) and sampled random points from it.Then, we extracted the environmental variables from the presence and pseudo-absence points using the extract function from the terra package. This allowed us to create a dataset with the presence and absence points, along with the environmental variables.extracted_predictors_raw &lt;- as.data.frame(terra::extract(Predictive_rasters, occs, xy=T, bind=T))extracted_predictors_raw2 &lt;- extracted_predictors_raw %&gt;% select(-\"Presence\",-\"x\",-\"y\", -\"Geo\", -\"Land_Use\")extracted_predictors &lt;- extracted_predictors_raw %&gt;% select(\"Presence\",\"x\",\"y\",\"Geo\",\"Land_Use\")# Fill missing dataextracted_NA_kNN &lt;- caret::preProcess(extracted_predictors_raw2, method=\"bagImpute\")missing_points &lt;- predict(extracted_NA_kNN, extracted_predictors_raw2)cliff_data &lt;- cbind(extracted_predictors, missing_points)Note the use of caret::preProcess to fill missing data using bagInputing (based on Regression Trees), but other options are available (mean, median, knn or linear imputation ). This is a common approach to handle missing data in SDMs, as it allows us to use all available data without losing information, as some supervised learning algorithms do not handle missing data well.Although some altogrithm can handle well with correlated variables, it is a good practice to check for multicollinearity in the predictors. In this case, we used the vif function from the usdm package to calculate the Variance Inflation Factor (VIF) and remove highly correlated variables.loop_val &lt;- 100while (loop_val &gt;= 10) { Numeric_spg &lt;- cliff_data %&gt;% select(-\"Presence\",-\"x\",-\"y\") %&gt;% select_if(.,is.numeric) VIF_numeric &lt;- usdm::vif(Numeric_spg[,6:length(Numeric_spg)]) %&gt;% arrange(VIF) VIF_numeric Selected_variables &lt;- VIF_numeric[-c(length(VIF_numeric$VIF)),] cliff_selected_data &lt;- cliff_data %&gt;% select(\"Presence\",\"x\",\"y\",names(Numeric_spg[,1:5]), Selected_variables$Variables,names(Not_Numeric_spg)) loop_val &lt;- VIF_numeric[c(length(VIF_numeric$VIF)),2] print(paste(\"max VIF at\", loop_val))}Finally, we used the ranger package to train a Random Forest model on the data. The model was trained using 40-fold cross-validation and repeated 40 times to ensure robustness. The model was then used to predict the distribution of cliff species in Mallorca. We opted to use RandomForest as it is a flexible algorithm that can handle non-linear relationships, less restrictive assumptions about the data than Generalised Linear Models, and is robust to overfitting.# Random Forest model ####cliff_selected_data$Presence &lt;- as.factor(cliff_selected_data$Presence)levels(cliff_selected_data$Presence) &lt;- c(\"Ausence\",\"Presence\")rf.task &lt;- makeClassifTask(data = cliff_selected_data, target = \"Presence\")res &lt;- tuneRanger(rf.task, measure = list(multiclass.brier), num.trees = 500, num.threads = 20, iters = 100, save.file.path = NULL)cliff_RF_model &lt;- caret::train( cliff_selected_data[,-1], # This way the factor rasters are keep together as.factor(cliff_selected_data$Presence), method = \"ranger\", trControl = trainControl(method = \"repeatedcv\", # k-fold cross-validation number = 40, # 40 folds repeats = 40, # repeated 40 times allowParallel = T, classProbs=T, returnData = T, savePredictions = \"final\"), tuneGrid = expand.grid(mtry = res$recommended.pars[,1], min.node.size = res$recommended.pars[,2], splitrule = \"gini\"), num.trees = 500, num.threads = 20, importance = 'impurity')After training the model, we evaluated its performance using the confusionMatrix function from the caret package. This allowed us to assess the accuracy of the model and its ability to correctly classify presence and absence points.conf_RF &lt;- confusionMatrix(cliff_RF_model)$tableThe confusion matrix showed that the model had a high accuracy, with a sensitivity of X and a specificity of Xâ€¦One of the most beatifoul things about randomForest is that it provides a measure of variable importance, which can be used to understand which environmental variables are most important for the distribution of cliff species. We used importance function from the ranger package to obtain the variable importance scores and plotted them using ggplot2.importance_scores &lt;- as.data.frame(importance(cliff_RF_model$finalModel))importance_scores$Variable &lt;- rownames(importance_scores)importance_scores &lt;- importance_scores %&gt;% arrange(desc(IncNodePurity))With a little bit of ggplot magic, we can visualize the importance of each variable in the modelAlso, we are able to see how the model undestands the relationship between the environmental variables and the presence of cliff species. We can use the partialPlot function from the ranger package to visualize the partial dependence of each variable on the model predictions.vars &lt;- c(\"BIO9\", \"BIO19\", \"Slope\", \"BIO4\", \"Elevation\", \"BIO3\")plots &lt;- lapply(vars, function(var) { pd &lt;- partial(cliff_RF_model, pred.var = var, train = my_data, prob = TRUE) autoplot(pd) + ggtitle(var) + theme_minimal()})grid.arrange(grobs = plots, ncol = 3)We can observe that the model predicts relationships between probability of presence and onvironmental variables, such as BIO9 (Mean Temperature of Driest Quarter), BIO19 (Precipitation of Coldest Quarter), Slope, BIO4 (Temperature Seasonality), Elevation and BIO3 (Isothermality) quite different than lineal or logistic, which is one of the advantages of using tree-based models.Finally, we can use the trained model to predict the distribution of cliff species in Mallorca. We used the predict function from the terra package to make predictions on the environmental variables raster data, generating directly a raster file which can be easily visualized in QGIS or any other GIS software.We can observe how the model predicts the distribution of cliff species. Mallorca, because of its high mountainous areas in comparison to the other islands, has a high probability of presence of cliff species in the north and northwest areas, where the highest cliffs are located. The model also predicts lower probabilities of presence in the southern and eastern areas, where the cliffs are less pronounced.Finally, we can change environmental raster variables to predict how the distribution of cliff species would change under different scenarios of climate change.In comparison with the current distribution, we can see that distribution area is considerably reduced in future scenarios of climate change, even in the most moderate (SSP1-2.6), as a result of modifications temperatures and precipitation patterns. This highlights the importance of using SDMs to predict the impact of climate change on species distribution and inform conservation efforts.Using Random Forests to model the distribution of cliff species in Mallorca, we predict a significant reduction in their distribution area under climate change scenarios, enhancing their conservation priorityNote: we have ommited train-test split and hyperparameter tuning for simplicity, but it is a good practice to avoid overfitting and achieve better generalization capabilities"
    } ,
  
    {
      "title"       : "Begining of life. Using GLMs to understand plant germination",
      "category"    : "theory",
      "tags"        : "",
      "url"         : "./Using_GLM_germination.html",
      "date"        : "2021-04-02 00:00:00 +0200",
      "description" : "",
      "content"     : "Under development"
    } ,
  
    {
      "title"       : "Aplying System Dynamics Models To Mar Menor Lagoon",
      "category"    : "",
      "tags"        : "general blogging, thoughts, life",
      "url"         : "./SDM_Mar_Menor.html",
      "date"        : "2021-03-24 00:00:00 +0100",
      "description" : "",
      "content"     : "Under development"
    } ,
  
    {
      "title"       : "Using Capture-Recapture models to estimate population dynamics",
      "category"    : "",
      "tags"        : "",
      "url"         : "./Alytes-population-dynamics.html",
      "date"        : "2021-03-18 22:14:20 +0100",
      "description" : "Inspired by Deep Mind's astonishing feats of having their Alpha Go, Alpha Zero and Alpha Star programs learn (and be amazing at it) Go, Chess, Atari games and lately Starcraft; I set myself to the task of programming a neural network that will learn by itself how to play the ancient game of tic tac toe. How hard could it be?",
      "content"     : "Background"
    } ,
  
    {
      "title"       : "Analysing allien plant species introduction in the Balearic Islands",
      "category"    : "",
      "tags"        : "R, allien species, Time series, GLMs, unsupervised learning, hierarchical clustering",
      "url"         : "./Allien_species_introduction.html",
      "date"        : "2021-03-12 20:32:20 +0100",
      "description" : "Some neural network optimization algorithms mostly to implement momentum when doing back propagation.",
      "content"     : "Extensive material and methods and results from this study can be read in the original manuscript in the Journal Biodiversity and ConservationIn this post we will focus on the introduction of plant allien species in the Balearic Islands, and how we can use machine learning to analyse future trends based on historical data.The main challenge in this study was to gather all publicly available data regarding introductions and think about the visualizations that would be most useful to understand the trends in the introduction of the species. From the data we gathered (one row per citation) we characterized information about the taxa (life form, taxonomic family, biogeographical origin) and about the introduction (path, date, habitat). We used this information to carry out Generalised Linear Models as follows:Habitat_predicted_data=expand.grid( Fecha=c(1800:2100), Habitat=Habitat_datamodel$Habitat)Habitat_year_model=glm(N~Fecha+Habitat, family=poisson(link=\"log\"), data=Habitat_datamodel)Habitat_year_model_int=glm(N~Fecha*Habitat, family=poisson(link=\"log\"), data=Habitat_datamodel)AIC(Habitat_year_model_int, Habitat_year_model)summary(aov(Habitat_year_model_int))pscl::pR2(Habitat_year_model_int)[4]#0.81car::Anova(Habitat_year_model_int,type=\"III\",singular.ok =TRUE)For each variable, we used Poisson family as indicated for count data, testing model signicance with a Chi-squared test. The results showed that the model was significant, and we could use it to predict future trends in the introduction of allien species. We used car::Anova to get the significance of each variable in the model, and pscl::pR2 to get the pseudo R-squared value of the model.Defined the most accurate model, we used it to make it out predictions:predicted_intro=predict(Habitat_year_model_int, newdata=Habitat_predicted_data, type=\"response\", se.fit = TRUE)Note se.fit to TRUE to get the standard error of the predictions, which we used to calculate confidence intervals for the predictions. Plotting was carried out as follows:Habitat_year_plot=Habitat_plot_data%&gt;% ggplot(aes(x=Fecha,y=fit,col=Habitat))+ geom_vline(aes(xintercept=2023),lty=2,col=\"#a9a9a9\")+ geom_line(lty=2)+ geom_ribbon(aes(ymin=fit-se.fit,ymax=fit+se.fit, fill=Habitat, ),alpha=0.2,col=NA)+ geom_point(data=Habitat_datamodel,alpha=0.2, aes(y=N))+ ylab(\"Number of taxa\")+ labs(title=\"Habitat\", subtitle=paste0(\"Factor sig. (Df= 6, F= 239.53, p&lt; 0.001); Interaction sig. (Df=6 , LR= 58.64, p&lt; 0.001)\"), caption=paste0(\"Model p-value&lt; 0.001; R2: 0.88\"))+ coord_cartesian(xlim=c(1800,2150))+ scale_colour_manual(name=\"Blackburn index\", values = fun_color_range(length(levels(as.factor(Habitat_datamodel$Habitat)))))+ scale_fill_manual(name=\"Blackburn index\", values = fun_color_range(length(levels(as.factor(Habitat_datamodel$Habitat)))))+ theme_minimal()+ theme(legend.position = \"top\", plot.title=element_text(hjust=0.5), plot.subtitle=element_text(size=8, hjust=0.5, face=\"italic\"), text=element_text(family=\"Helvetica\"))Habitat_year_label_plot=directlabels::direct.label.ggplot(Habitat_year_plot, list(\"last.points\", cex=0.5, fontface=\"bold\"))Although model statistics could be automatically extracted, we decided to include them in the plot as a subtitle for clarity. Note the inclusion of se.fit in the geom ribbon to include confidence intervals in the plot. On the other hand, we chosed to use directlabels library to label the lines in the plot, which allows for a cleaner visualization without overlapping labels. The final plot is shown below:We can observe that the introduction of allien species in the Balearic Islands has been increasing over time. The model predicts that this trend will continue in the future, with a significant increase in the number of introductions in the coming years, which could reach more than 1000 species, representing &gt;50% of the total number of plant species in the Balearic Islands.If current trends in allien species introductions continue, by 2100 exotic species could represent &gt;50% of the total number of plant species in the Balearic Islands.On the other hand, we can see that habitats related to human disturbance are more prone to introuctions, as well as some origins like Capense and neotropical among Cactaceae and Asteraceae family. The main introduction path is ornamental, no unintencional, so conservation efforts should focus on controlling them regualting their importation.In the Balearic Islands main introduction pathways of plant allien speies are ornamental, no unintentional, highlighting the need for stricter regulations on plant imports.We also aimed to analyse if allien species introductions were similar among islands. To do so, wu used unspervised machine learnign with hierarchical clustering to group islands based on the presence of allien species. We transformed islands to columns and taxa to rows, indicating 1/0 for presence/absence of the species in each island, and then calulated the distance matrix using Euclidean distance. The clustering was done using Wardâ€™s method, which is a hierarchical clustering method that minimizes the variance within clusters.\\(\\Delta(A, B) = \\dfrac{|A| \\cdot |B|}{|A| + |B|} \\cdot \\left\\| \\bar{x}_A - \\bar{x}_B \\right\\|^2\\)where A and B are the clusters, \\(|A|\\) and \\(|B|\\) are the number of elements in each cluster, and \\(\\bar{x}_A\\) and \\(\\bar{x}_B\\) are the centroids of each cluster. The distance between clusters is calculated as the product of the number of elements in each cluster divided by the sum of the number of elements in both clusters, multiplied by the squared distance between the centroids of each cluster. A_PCA=A_islas[2:7]A_PCA[is.na(A_PCA)]=0Data_matrix=t(A_PCA)colnames(Data_matrix)=A_islas[1]$Taxad=dist(Data_matrix, method=\"euclidean\")clustering=hclust(d, method=\"ward.D\")We then plotted the dendrogram to visualize the clustering of islands based on the presence of allien species:ddata_x &lt;- dendro_data(as.dendrogram(clustering))labs &lt;- label(ddata_x)p2 &lt;- ggplot(segment(ddata_x)) + geom_segment(aes(x=x, y=y, xend=xend, yend=yend))+ geom_text(data=label(ddata_x), aes(label=label, x=x, y=0),colour=NA)+ ylab(\"Euclidean distance\")+ xlab(\"\")+ coord_flip()+ theme_blank()+ theme(text=element_text(family=\"Helvetica\"), axis.text.y = element_blank())p2The resulting plot shows that Ibiza and formentera are the most similar islands, sharing a common set of allien species. Mallorca and Menorca are also similar, btu different from minor islands, suggestign that island size plays a major role in the introduction, probably to major demographic pressure and human disturbance.And thatâ€™s all for this post! We hope you found it interesting and informative. If you have any questions or comments, feel free to reach out to us."
    } ,
  
    {
      "title"       : "Understanding bryophyte distribution using environmental data",
      "category"    : "",
      "tags"        : "",
      "url"         : "./Bryophyte_distribution-copy.html",
      "date"        : "2021-03-12 20:32:20 +0100",
      "description" : "",
      "content"     : "Under developmentAdam"
    } ,
  
    {
      "title"       : "Analysing pollination networks in R",
      "category"    : "",
      "tags"        : "",
      "url"         : "./pollination-networks.html",
      "date"        : "2021-03-12 20:32:20 +0100",
      "description" : "Some neural network optimization algorithms mostly to implement momentum when doing back propagation.",
      "content"     : "Under developmentAdam"
    } 
  
]
